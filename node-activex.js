"use strict";var answer,isConsole=!0,encodeFrom="",encodeTo="",jscript=require("jscript"),dynamic=require(__dirname+"/nodex/dynamic.js"),activex=jscript(__dirname+"/nodex/bundle.js",{json:!0});activex.on("data",function(a){answer&&answer(a)});var _=function(){function a(a,b){var c={deviceType:a,register:b};isConsole&&console.log("---REGISTER_DEVICE---: "+a),activex.write(c),dynamic.registerDevice({deviceType:a,guid:b})}function b(a){a&&activex.write(a)}function c(){activex.end(),dynamic.close()}function d(a,b){var c={deviceType:a,callBack:b};dynamic.registerCallBack(c)}function e(a){dynamic.endRegister(function(){a&&a()})}function f(a){answer=a,dynamic.answer(a)}function g(a){isConsole=a,dynamic.setConsole(a)}function h(a,b){encodeFrom=a,encodeTo=b}return{registerObject:a,registerCallBack:d,endCallBackRegistration:e,setConsole:g,setEncode:h,onMessage:f,send:b,close:c}}();module.exports=_;