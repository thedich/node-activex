"use strict";var answer,isConsole=!0,jscript=require("jscript"),dynamic=require("./nodex/dynamic.js"),activex=jscript("./nodex/bundle.js",{json:!0});activex.on("data",function(a){answer&&answer(a)});var _=function(){function a(a,b){var c={deviceType:a,register:b};isConsole&&console.log("---REGISTER_DEVICE---: "+a),activex.write(c),dynamic.registerDevice({deviceType:a,guid:b})}function b(a){a&&activex.write(a)}function c(){activex.end(),dynamic.close()}function d(a,b){var c={deviceType:a,callBack:b};dynamic.registerCallBack(c)}function e(a){dynamic.endRegister(function(){a&&a()})}function f(a){answer=a,dynamic.answer(a)}function g(a){isConsole=a,dynamic.setConsole(a)}return{registerObject:a,registerCallBack:d,endCallBackRegistration:e,setConsole:g,onMessage:f,send:b,close:c}}();module.exports=_;